2025-06-10 21:36:11,168 - INFO - configurar_logging - ============================================================
2025-06-10 21:36:11,168 - INFO - configurar_logging - 🚀 INICIANDO PROCESO ETL
2025-06-10 21:36:11,168 - INFO - configurar_logging - ============================================================
2025-06-10 21:36:11,415 - INFO - _conectar_bd - ✅ Conexión exitosa a BD: oulad_db
2025-06-10 21:36:11,416 - INFO - ejecutar_etl_completo - 🚀 Iniciando proceso ETL completo...
2025-06-10 21:36:11,416 - INFO - limpiar_tablas_bd - 🧹 Iniciando limpieza de tablas...
2025-06-10 21:36:11,416 - INFO - limpiar_tablas_bd - 🗑️ Limpiando tabla studentAssessment...
2025-06-10 21:36:11,418 - INFO - limpiar_tablas_bd - ✅ 0 registros eliminados de studentAssessment
2025-06-10 21:36:11,418 - INFO - limpiar_tablas_bd - 🗑️ Limpiando tabla studentVle...
2025-06-10 21:36:11,420 - INFO - limpiar_tablas_bd - ✅ 0 registros eliminados de studentVle
2025-06-10 21:36:11,420 - INFO - limpiar_tablas_bd - 🗑️ Limpiando tabla studentRegistration...
2025-06-10 21:36:11,421 - INFO - limpiar_tablas_bd - ✅ 0 registros eliminados de studentRegistration
2025-06-10 21:36:11,422 - INFO - limpiar_tablas_bd - 🗑️ Limpiando tabla studentInfo...
2025-06-10 21:36:11,426 - INFO - limpiar_tablas_bd - ✅ 0 registros eliminados de studentInfo
2025-06-10 21:36:11,426 - INFO - limpiar_tablas_bd - 🗑️ Limpiando tabla assessments...
2025-06-10 21:36:11,430 - INFO - limpiar_tablas_bd - ✅ 206 registros eliminados de assessments
2025-06-10 21:36:11,430 - INFO - limpiar_tablas_bd - 🗑️ Limpiando tabla vle...
2025-06-10 21:36:11,454 - INFO - limpiar_tablas_bd - ✅ 6364 registros eliminados de vle
2025-06-10 21:36:11,454 - INFO - limpiar_tablas_bd - 🗑️ Limpiando tabla courses...
2025-06-10 21:36:11,475 - INFO - limpiar_tablas_bd - ✅ 22 registros eliminados de courses
2025-06-10 21:36:11,477 - INFO - procesar_tabla - 📤 Procesando courses desde data/raw/courses.csv...
2025-06-10 21:36:11,480 - INFO - procesar_tabla - 📊 Cargados 22 registros
2025-06-10 21:36:11,481 - INFO - limpiar_valores_nulos - 🧹 Limpiando 0 valores NaN...
2025-06-10 21:36:11,483 - INFO - limpiar_valores_nulos - ✅ Limpieza completa: 0 → 0 valores NaN
2025-06-10 21:36:11,483 - INFO - normalizar_columnas_numericas - 📊 Normalizando 1 columnas numéricas (excluyendo claves primarias)...
2025-06-10 21:36:11,486 - INFO - normalizar_columnas_numericas - ✅ Normalización completada
2025-06-10 21:36:11,486 - INFO - convertir_categoricas_a_ordinales - 🔄 Convirtiendo 2 columnas categóricas a ordinales...
2025-06-10 21:36:11,523 - INFO - obtener_columnas_validas - 📋 Tabla courses: 3 columnas válidas
2025-06-10 21:36:11,523 - WARNING - procesar_tabla - ⚠️ Columnas omitidas: ['code_module_ord', 'code_presentation_ord']
2025-06-10 21:36:11,524 - INFO - validar_datos_pre_insercion - 🔍 Validando datos para tabla courses...
2025-06-10 21:36:11,526 - INFO - validar_datos_pre_insercion - ✅ Validación pre-inserción exitosa
2025-06-10 21:36:11,531 - INFO - generar_full_domain - 📚 Metadatos guardados: metadata/full_domains\courses_domain.json y metadata/full_domains\courses_domain.csv
2025-06-10 21:36:11,531 - INFO - procesar_tabla - 💾 Insertando 22 registros en courses...
2025-06-10 21:36:11,557 - INFO - guardar_mapeos - 🗂️ Mapeos guardados: mappings/courses_mappings.json
2025-06-10 21:36:11,558 - INFO - procesar_tabla - ✅ Tabla courses procesada exitosamente
2025-06-10 21:36:11,558 - INFO - procesar_tabla - 📤 Procesando vle desde data/raw/vle.csv...
2025-06-10 21:36:11,565 - INFO - procesar_tabla - 📊 Cargados 6364 registros
2025-06-10 21:36:11,566 - INFO - limpiar_valores_nulos - 🧹 Limpiando 10486 valores NaN...
2025-06-10 21:36:11,570 - INFO - limpiar_valores_nulos - ✅ Limpieza completa: 10486 → 0 valores NaN
2025-06-10 21:36:11,571 - INFO - normalizar_columnas_numericas - 📊 Normalizando 2 columnas numéricas (excluyendo claves primarias)...
2025-06-10 21:36:11,573 - INFO - normalizar_columnas_numericas - ✅ Normalización completada
2025-06-10 21:36:11,573 - INFO - procesar_tabla - 🚀 Aplicando FullDomain a vle...
2025-06-10 21:36:11,574 - INFO - crear_fulldomain_vle - 🔧 Creando FullDomain para VLE...
2025-06-10 21:36:11,579 - INFO - crear_fulldomain_vle - ✅ FullDomain creado. Ejemplo: resource_Puntual_Sin_Datos
2025-06-10 21:36:11,582 - INFO - guardar_reporte_fulldomain - 📊 Reporte FullDomain: reports/vle_fulldomain_report.json
2025-06-10 21:36:11,584 - INFO - convertir_categoricas_a_ordinales - 🔄 Convirtiendo 6 columnas categóricas a ordinales...
2025-06-10 21:36:11,606 - INFO - obtener_columnas_validas - 📋 Tabla vle: 6 columnas válidas
2025-06-10 21:36:11,606 - WARNING - procesar_tabla - ⚠️ Columnas omitidas: ['week_span', 'week_span_category', 'click_category', 'FullDomain', 'code_module_ord', 'code_presentation_ord', 'activity_type_ord', 'week_span_category_ord', 'click_category_ord', 'FullDomain_ord']
2025-06-10 21:36:11,608 - INFO - validar_datos_pre_insercion - 🔍 Validando datos para tabla vle...
2025-06-10 21:36:11,615 - INFO - validar_datos_pre_insercion - ✅ Validación pre-inserción exitosa
2025-06-10 21:36:11,636 - INFO - generar_full_domain - 📚 Metadatos guardados: metadata/full_domains\vle_domain.json y metadata/full_domains\vle_domain.csv
2025-06-10 21:36:11,637 - INFO - procesar_tabla - 💾 Insertando 6364 registros en vle...
2025-06-10 21:36:11,949 - INFO - guardar_mapeos - 🗂️ Mapeos guardados: mappings/vle_mappings.json
2025-06-10 21:36:11,949 - INFO - procesar_tabla - ✅ Tabla vle procesada exitosamente
2025-06-10 21:36:11,949 - INFO - procesar_tabla - 📤 Procesando assessments desde data/raw/assessments.csv...
2025-06-10 21:36:11,951 - INFO - procesar_tabla - 📊 Cargados 206 registros
2025-06-10 21:36:11,951 - INFO - limpiar_valores_nulos - 🧹 Limpiando 11 valores NaN...
2025-06-10 21:36:11,953 - INFO - limpiar_valores_nulos - ✅ Limpieza completa: 11 → 0 valores NaN
2025-06-10 21:36:11,954 - INFO - normalizar_columnas_numericas - 📊 Normalizando 2 columnas numéricas (excluyendo claves primarias)...
2025-06-10 21:36:11,956 - INFO - normalizar_columnas_numericas - ✅ Normalización completada
2025-06-10 21:36:11,956 - INFO - procesar_tabla - 🚀 Aplicando FullDomain a assessments...
2025-06-10 21:36:11,956 - INFO - crear_fulldomain_assessments - 🔧 Creando FullDomain para assessments...
2025-06-10 21:36:11,962 - INFO - crear_fulldomain_assessments - ✅ FullDomain creado. Ejemplo: TMA_Bajo_Temprano
2025-06-10 21:36:11,965 - INFO - guardar_reporte_fulldomain - 📊 Reporte FullDomain: reports/assessments_fulldomain_report.json
2025-06-10 21:36:11,965 - INFO - convertir_categoricas_a_ordinales - 🔄 Convirtiendo 6 columnas categóricas a ordinales...
2025-06-10 21:36:11,982 - INFO - obtener_columnas_validas - 📋 Tabla assessments: 6 columnas válidas
2025-06-10 21:36:11,983 - WARNING - procesar_tabla - ⚠️ Columnas omitidas: ['weight_category', 'date_category', 'FullDomain', 'code_module_ord', 'code_presentation_ord', 'assessment_type_ord', 'weight_category_ord', 'date_category_ord', 'FullDomain_ord']
2025-06-10 21:36:11,984 - INFO - validar_datos_pre_insercion - 🔍 Validando datos para tabla assessments...
2025-06-10 21:36:11,985 - INFO - validar_datos_pre_insercion - ✅ Validación pre-inserción exitosa
2025-06-10 21:36:11,990 - INFO - generar_full_domain - 📚 Metadatos guardados: metadata/full_domains\assessments_domain.json y metadata/full_domains\assessments_domain.csv
2025-06-10 21:36:11,990 - INFO - procesar_tabla - 💾 Insertando 206 registros en assessments...
2025-06-10 21:36:12,042 - INFO - guardar_mapeos - 🗂️ Mapeos guardados: mappings/assessments_mappings.json
2025-06-10 21:36:12,042 - INFO - procesar_tabla - ✅ Tabla assessments procesada exitosamente
2025-06-10 21:36:12,042 - INFO - procesar_tabla - 📤 Procesando studentInfo desde data/raw/studentInfo.csv...
2025-06-10 21:36:12,084 - INFO - procesar_tabla - 📊 Cargados 32593 registros
2025-06-10 21:36:12,094 - INFO - limpiar_valores_nulos - 🧹 Limpiando 1111 valores NaN...
2025-06-10 21:36:12,120 - INFO - limpiar_valores_nulos - ✅ Limpieza completa: 1111 → 0 valores NaN
2025-06-10 21:36:12,122 - INFO - normalizar_columnas_numericas - 📊 Normalizando 2 columnas numéricas (excluyendo claves primarias)...
2025-06-10 21:36:12,125 - INFO - normalizar_columnas_numericas - ✅ Normalización completada
2025-06-10 21:36:12,130 - INFO - convertir_categoricas_a_ordinales - 🔄 Convirtiendo 9 columnas categóricas a ordinales...
2025-06-10 21:36:12,164 - INFO - procesar_tabla - 🔄 Eliminados 3808 duplicados
2025-06-10 21:36:12,165 - INFO - obtener_columnas_validas - 📋 Tabla studentInfo: 12 columnas válidas
2025-06-10 21:36:12,165 - WARNING - procesar_tabla - ⚠️ Columnas omitidas: ['code_module_ord', 'code_presentation_ord', 'gender_ord', 'region_ord', 'highest_education_ord', 'imd_band_ord', 'age_band_ord', 'disability_ord', 'final_result_ord']
2025-06-10 21:36:12,170 - INFO - validar_datos_pre_insercion - 🔍 Validando datos para tabla studentInfo...
2025-06-10 21:36:12,247 - INFO - validar_datos_pre_insercion - ✅ Validación pre-inserción exitosa
2025-06-10 21:36:12,297 - INFO - generar_full_domain - 📚 Metadatos guardados: metadata/full_domains\studentInfo_domain.json y metadata/full_domains\studentInfo_domain.csv
2025-06-10 21:36:12,297 - INFO - procesar_tabla - 💾 Insertando 28785 registros en studentInfo...
2025-06-10 21:36:12,697 - ERROR - procesar_tabla - ❌ Error procesando studentInfo: (pyodbc.ProgrammingError) ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]String or binary data would be truncated in table 'oulad_db.dbo.studentInfo', column 'imd_band'. Truncated value: 'Desconocid'. (2628) (SQLExecDirectW); [42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]The statement has been terminated. (3621)")
[SQL: INSERT INTO [studentInfo] (code_module, code_presentation, id_student, gender, region, highest_education, imd_band, age_band, num_of_prev_attempts, studied_credits, disability, final_result) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ? ... 6458 characters truncated ...  ?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: ('AAA', '2013J', 11391, 'M', 'East Anglian Region', 'HE Qualification', '90-100%', '55<=', 0.0, 0.336, 'N', 'Pass', 'AAA', '2013J', 28400, 'F', 'Scotland', 'HE Qualification', '20-30%', '35-55', 0.0, 0.048, 'N', 'Pass', 'AAA', '2013J', 30268, 'F', 'North Western Region', 'A Level or Equivalent', '30-40%', '35-55', 0.0, 0.048, 'Y', 'Withdrawn', 'AAA', '2013J', 31604, 'F', 'South East Region', 'A Level or Equivalent', '50-60%', '35-55', 0.0, 0.048, 'N', 'Pass', 'AAA', '2013J' ... 1988 parameters truncated ... 'N', 'Fail', 'AAA', '2013J', 350188, 'M', 'North Western Region', 'HE Qualification', '80-90%', '35-55', 0.0, 0.048, 'N', 'Pass', 'AAA', '2013J', 354858, 'M', 'South Region', 'HE Qualification', '90-100%', '35-55', 0.0, 0.14400000000000002, 'N', 'Withdrawn', 'AAA', '2013J', 357668, 'M', 'Yorkshire Region', 'A Level or Equivalent', '10-20', '0-35', 0.0, 0.048, 'N', 'Fail', 'AAA', '2013J', 364177, 'M', 'East Anglian Region', 'Lower Than A Level', '70-80%', '35-55', 0.0, 0.048, 'N', 'Fail')]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-06-10 21:36:12,697 - WARNING - ejecutar_etl_completo - ⚠️ Tabla studentInfo tuvo errores pero continuando...
2025-06-10 21:36:12,698 - INFO - procesar_tabla - 📤 Procesando studentRegistration desde data/raw/studentRegistration.csv...
2025-06-10 21:36:12,717 - INFO - procesar_tabla - 📊 Cargados 32593 registros
2025-06-10 21:36:12,720 - INFO - limpiar_valores_nulos - 🧹 Limpiando 22566 valores NaN...
2025-06-10 21:36:12,728 - INFO - limpiar_valores_nulos - ✅ Limpieza completa: 22566 → 0 valores NaN
2025-06-10 21:36:12,729 - INFO - normalizar_columnas_numericas - 📊 Normalizando 2 columnas numéricas (excluyendo claves primarias)...
2025-06-10 21:36:12,732 - INFO - normalizar_columnas_numericas - ✅ Normalización completada
2025-06-10 21:36:12,733 - INFO - convertir_categoricas_a_ordinales - 🔄 Convirtiendo 2 columnas categóricas a ordinales...
2025-06-10 21:36:12,769 - INFO - obtener_columnas_validas - 📋 Tabla studentRegistration: 5 columnas válidas
2025-06-10 21:36:12,769 - WARNING - procesar_tabla - ⚠️ Columnas omitidas: ['code_module_ord', 'code_presentation_ord']
2025-06-10 21:36:12,770 - INFO - validar_datos_pre_insercion - 🔍 Validando datos para tabla studentRegistration...
2025-06-10 21:36:12,794 - INFO - validar_datos_pre_insercion - ✅ Validación pre-inserción exitosa
2025-06-10 21:36:12,814 - INFO - generar_full_domain - 📚 Metadatos guardados: metadata/full_domains\studentRegistration_domain.json y metadata/full_domains\studentRegistration_domain.csv
2025-06-10 21:36:12,814 - INFO - procesar_tabla - 💾 Insertando 32593 registros en studentRegistration...
2025-06-10 21:36:13,114 - ERROR - procesar_tabla - ❌ Error procesando studentRegistration: (pyodbc.IntegrityError) ('23000', '[23000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]The INSERT statement conflicted with the FOREIGN KEY constraint "FK__studentRe__id_st__4222D4EF". The conflict occurred in database "oulad_db", table "dbo.studentInfo", column \'id_student\'. (547) (SQLExecDirectW); [23000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]The statement has been terminated. (3621)')
[SQL: INSERT INTO [studentRegistration] (code_module, code_presentation, id_student, date_registration, date_unregistration) VALUES (?, ?, ?, ?, ?), (?, ?, ?, ?, ?), (?, ?, ?, ?, ?), (?, ?, ?, ?, ?), (?, ?, ?, ?, ?), (?, ?, ?, ?, ?), (?, ?, ?, ?, ?), (?, ? ... 6897 characters truncated ... (?, ?, ?, ?, ?), (?, ?, ?, ?, ?), (?, ?, ?, ?, ?), (?, ?, ?, ?, ?), (?, ?, ?, ?, ?), (?, ?, ?, ?, ?)]
[parameters: ('AAA', '2013J', 11391, 0.33333333333333337, 0.48454882571075397, 'AAA', '2013J', 28400, 0.5501022494887526, 0.48454882571075397, 'AAA', '2013J', 30268, 0.47034764826175873, 0.4660074165636588, 'AAA', '2013J', 31604, 0.5521472392638037, 0.48454882571075397, 'AAA', '2013J', 32885, 0.29856850715746425, 0.48454882571075397, 'AAA', '2013J', 38053, 0.4335378323108385, 0.48454882571075397, 'AAA', '2013J', 45462, 0.5214723926380369, 0.48454882571075397, 'AAA', '2013J', 45642, 0.5991820040899796, 0.48454882571075397, 'AAA', '2013J', 52130, 0.591002044989775, 0.48454882571075397, 'AAA', '2013J', 53025, 0.29243353783231085, 0.48454882571075397 ... 1995 parameters truncated ... 'AAA', '2014J', 111512, 0.6257668711656442, 0.48454882571075397, 'AAA', '2014J', 117818, 0.47034764826175873, 0.48454882571075397, 'AAA', '2014J', 119902, 0.5950920245398773, 0.7070457354758961, 'AAA', '2014J', 121349, 0.6012269938650308, 0.48454882571075397, 'AAA', '2014J', 124064, 0.5685071574642128, 0.48454882571075397, 'AAA', '2014J', 125018, 0.5848670756646217, 0.48454882571075397, 'AAA', '2014J', 129955, 0.36605316973415136, 0.6279357231149567, 'AAA', '2014J', 130034, 0.49079754601227, 0.48454882571075397, 'AAA', '2014J', 130547, 0.6073619631901841, 0.48454882571075397, 'AAA', '2014J', 130636, 0.5194274028629857, 0.48454882571075397)]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-06-10 21:36:13,114 - WARNING - ejecutar_etl_completo - ⚠️ Tabla studentRegistration tuvo errores pero continuando...
2025-06-10 21:36:13,115 - INFO - procesar_tabla - 📤 Procesando studentVle desde data/raw/studentVle.csv...
2025-06-10 21:36:16,955 - INFO - procesar_tabla - 📊 Cargados 10655280 registros
2025-06-10 21:36:17,551 - INFO - limpiar_valores_nulos - 🧹 Limpiando 0 valores NaN...
2025-06-10 21:36:19,687 - INFO - limpiar_valores_nulos - ✅ Limpieza completa: 0 → 0 valores NaN
2025-06-10 21:36:19,890 - INFO - normalizar_columnas_numericas - 📊 Normalizando 1 columnas numéricas (excluyendo claves primarias)...
2025-06-10 21:36:20,059 - INFO - normalizar_columnas_numericas - ✅ Normalización completada
2025-06-10 21:36:20,403 - INFO - convertir_categoricas_a_ordinales - 🔄 Convirtiendo 2 columnas categóricas a ordinales...
2025-06-10 21:36:24,480 - INFO - procesar_tabla - 🔄 Eliminados 2195960 duplicados
2025-06-10 21:36:24,502 - INFO - obtener_columnas_validas - 📋 Tabla studentVle: 6 columnas válidas
2025-06-10 21:36:24,502 - WARNING - procesar_tabla - ⚠️ Columnas omitidas: ['code_module_ord', 'code_presentation_ord']
2025-06-10 21:36:24,827 - INFO - validar_datos_pre_insercion - 🔍 Validando datos para tabla studentVle...
2025-06-10 21:36:31,409 - INFO - validar_datos_pre_insercion - ✅ Validación pre-inserción exitosa
2025-06-10 21:36:34,846 - INFO - generar_full_domain - 📚 Metadatos guardados: metadata/full_domains\studentVle_domain.json y metadata/full_domains\studentVle_domain.csv
2025-06-10 21:36:34,846 - INFO - procesar_tabla - 💾 Insertando 8459320 registros en studentVle...
2025-06-10 21:37:14,275 - ERROR - procesar_tabla - ❌ Error procesando studentVle: (pyodbc.IntegrityError) ('23000', '[23000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]The INSERT statement conflicted with the FOREIGN KEY constraint "FK__studentVl__id_st__4AB81AF0". The conflict occurred in database "oulad_db", table "dbo.studentInfo", column \'id_student\'. (547) (SQLExecDirectW); [23000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]The statement has been terminated. (3621)')
[SQL: INSERT INTO [studentVle] (code_module, code_presentation, id_student, id_site, date, sum_click) VALUES (?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?), (?, ?,  ... 6731 characters truncated ... , (?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?)]
[parameters: ('AAA', '2013J', 28400, 546652, -10, 0.00043004587155963305, 'AAA', '2013J', 28400, 546614, -10, 0.0014334862385321102, 'AAA', '2013J', 28400, 546714, -10, 0.0, 'AAA', '2013J', 28400, 546876, -10, 0.00014334862385321102, 'AAA', '2013J', 28400, 546688, -10, 0.0020068807339449542, 'AAA', '2013J', 28400, 546662, -10, 0.0022935779816513763, 'AAA', '2013J', 28400, 546890, -10, 0.0, 'AAA', '2013J', 28400, 547011, -10, 0.0, 'AAA', '2013J' ... 1994 parameters truncated ... -10, 0.0, 'AAA', '2013J', 145130, 546672, -10, 0.0, 'AAA', '2013J', 145130, 546681, -10, 0.0, 'AAA', '2013J', 145130, 546719, -10, 0.00014334862385321102, 'AAA', '2013J', 145130, 546879, -10, 0.0005733944954128441, 'AAA', '2013J', 146188, 546614, -10, 0.0005733944954128441, 'AAA', '2013J', 146188, 546669, -10, 0.0005733944954128441, 'AAA', '2013J', 145130, 546668, -10, 0.0, 'AAA', '2013J', 145130, 546614, -10, 0.0)]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-06-10 21:37:14,276 - WARNING - ejecutar_etl_completo - ⚠️ Tabla studentVle tuvo errores pero continuando...
2025-06-10 21:37:14,276 - INFO - procesar_tabla - 📤 Procesando studentAssessment desde data/raw/studentAssessment.csv...
2025-06-10 21:37:14,369 - INFO - procesar_tabla - 📊 Cargados 173912 registros
2025-06-10 21:37:14,372 - INFO - limpiar_valores_nulos - 🧹 Limpiando 173 valores NaN...
2025-06-10 21:37:14,401 - INFO - limpiar_valores_nulos - ✅ Limpieza completa: 173 → 0 valores NaN
2025-06-10 21:37:14,408 - INFO - normalizar_columnas_numericas - 📊 Normalizando 3 columnas numéricas (excluyendo claves primarias)...
2025-06-10 21:37:14,424 - INFO - normalizar_columnas_numericas - ✅ Normalización completada
2025-06-10 21:37:14,464 - INFO - obtener_columnas_validas - 📋 Tabla studentAssessment: 5 columnas válidas
2025-06-10 21:37:14,468 - INFO - validar_datos_pre_insercion - 🔍 Validando datos para tabla studentAssessment...
2025-06-10 21:37:14,489 - INFO - validar_datos_pre_insercion - ✅ Validación pre-inserción exitosa
2025-06-10 21:37:14,551 - INFO - generar_full_domain - 📚 Metadatos guardados: metadata/full_domains\studentAssessment_domain.json y metadata/full_domains\studentAssessment_domain.csv
2025-06-10 21:37:14,551 - INFO - procesar_tabla - 💾 Insertando 173912 registros en studentAssessment...
2025-06-10 21:37:17,812 - ERROR - procesar_tabla - ❌ Error procesando studentAssessment: (pyodbc.IntegrityError) ('23000', '[23000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]The INSERT statement conflicted with the FOREIGN KEY constraint "FK__studentAs__id_st__46E78A0C". The conflict occurred in database "oulad_db", table "dbo.studentInfo", column \'id_student\'. (547) (SQLExecDirectW); [23000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]The statement has been terminated. (3621)')
[SQL: INSERT INTO [studentAssessment] (id_assessment, id_student, date_submitted, is_banked, score) VALUES (?, ?, ?, ?, ?), (?, ?, ?, ?, ?), (?, ?, ?, ?, ?), (?, ?, ?, ?, ?), (?, ?, ?, ?, ?), (?, ?, ?, ?, ?), (?, ?, ?, ?, ?), (?, ?, ?, ?, ?), (?, ?, ?, ?,  ... 6872 characters truncated ... (?, ?, ?, ?, ?), (?, ?, ?, ?, ?), (?, ?, ?, ?, ?), (?, ?, ?, ?, ?), (?, ?, ?, ?, ?), (?, ?, ?, ?, ?)]
[parameters: (1752, 11391, 0.04684975767366721, 0.0, 0.78, 1752, 28400, 0.053311793214862686, 0.0, 0.7000000000000001, 1752, 31604, 0.04523424878836834, 0.0, 0.72, 1752, 32885, 0.05977382875605816, 0.0, 0.6900000000000001, 1752, 38053, 0.048465266558966075, 0.0, 0.79, 1752, 45462, 0.050080775444264945, 0.0, 0.7000000000000001, 1752, 45642, 0.04684975767366721, 0.0, 0.72, 1752, 52130, 0.048465266558966075, 0.0, 0.72, 1752, 53025, 0.03231017770597738, 0.0, 0.71, 1752, 57506, 0.04684975767366721, 0.0, 0.68 ... 1995 parameters truncated ... 1753, 2139353, 0.11308562197092084, 0.0, 0.62, 1753, 2143752, 0.10339256865912763, 0.0, 0.56, 1753, 2146792, 0.10500807754442651, 0.0, 0.6, 1753, 2153153, 0.10339256865912763, 0.0, 0.67, 1753, 2155014, 0.11793214862681745, 0.0, 0.64, 1753, 2171627, 0.09854604200323103, 0.0, 0.67, 1753, 2182846, 0.1001615508885299, 0.0, 0.63, 1753, 2194100, 0.10177705977382875, 0.0, 0.61, 1753, 2197016, 0.1001615508885299, 0.0, 0.75, 1753, 2208424, 0.10339256865912763, 0.0, 0.5700000000000001)]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-06-10 21:37:17,813 - WARNING - ejecutar_etl_completo - ⚠️ Tabla studentAssessment tuvo errores pero continuando...
2025-06-10 21:37:17,813 - INFO - generar_reporte_final - 📋 Generando reporte final...
2025-06-10 21:37:17,815 - INFO - generar_reporte_final - ✅ Reporte final: reports/etl_final_report_20250610_213717.json
2025-06-10 21:37:17,815 - INFO - generar_reporte_final - ============================================================
2025-06-10 21:37:17,815 - INFO - generar_reporte_final - 📊 RESUMEN FINAL DEL PROCESO ETL
2025-06-10 21:37:17,815 - INFO - generar_reporte_final - ============================================================
2025-06-10 21:37:17,815 - INFO - generar_reporte_final - ✅ Tablas procesadas: 3
2025-06-10 21:37:17,815 - INFO - generar_reporte_final - 📝 Registros insertados: 6592
2025-06-10 21:37:17,816 - INFO - generar_reporte_final - ⏱️ Duración total: 0:01:06.645116
2025-06-10 21:37:17,816 - INFO - generar_reporte_final - ❌ Errores: 4
2025-06-10 21:37:17,816 - WARNING - generar_reporte_final - ⚠️ ERRORES DETECTADOS:
2025-06-10 21:37:17,816 - WARNING - generar_reporte_final -    - studentInfo: (pyodbc.ProgrammingError) ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]String or binary data would be truncated in table 'oulad_db.dbo.studentInfo', column 'imd_band'. Truncated value: 'Desconocid'. (2628) (SQLExecDirectW); [42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]The statement has been terminated. (3621)")
[SQL: INSERT INTO [studentInfo] (code_module, code_presentation, id_student, gender, region, highest_education, imd_band, age_band, num_of_prev_attempts, studied_credits, disability, final_result) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ? ... 6458 characters truncated ...  ?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: ('AAA', '2013J', 11391, 'M', 'East Anglian Region', 'HE Qualification', '90-100%', '55<=', 0.0, 0.336, 'N', 'Pass', 'AAA', '2013J', 28400, 'F', 'Scotland', 'HE Qualification', '20-30%', '35-55', 0.0, 0.048, 'N', 'Pass', 'AAA', '2013J', 30268, 'F', 'North Western Region', 'A Level or Equivalent', '30-40%', '35-55', 0.0, 0.048, 'Y', 'Withdrawn', 'AAA', '2013J', 31604, 'F', 'South East Region', 'A Level or Equivalent', '50-60%', '35-55', 0.0, 0.048, 'N', 'Pass', 'AAA', '2013J' ... 1988 parameters truncated ... 'N', 'Fail', 'AAA', '2013J', 350188, 'M', 'North Western Region', 'HE Qualification', '80-90%', '35-55', 0.0, 0.048, 'N', 'Pass', 'AAA', '2013J', 354858, 'M', 'South Region', 'HE Qualification', '90-100%', '35-55', 0.0, 0.14400000000000002, 'N', 'Withdrawn', 'AAA', '2013J', 357668, 'M', 'Yorkshire Region', 'A Level or Equivalent', '10-20', '0-35', 0.0, 0.048, 'N', 'Fail', 'AAA', '2013J', 364177, 'M', 'East Anglian Region', 'Lower Than A Level', '70-80%', '35-55', 0.0, 0.048, 'N', 'Fail')]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-06-10 21:37:17,817 - WARNING - generar_reporte_final -    - studentRegistration: (pyodbc.IntegrityError) ('23000', '[23000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]The INSERT statement conflicted with the FOREIGN KEY constraint "FK__studentRe__id_st__4222D4EF". The conflict occurred in database "oulad_db", table "dbo.studentInfo", column \'id_student\'. (547) (SQLExecDirectW); [23000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]The statement has been terminated. (3621)')
[SQL: INSERT INTO [studentRegistration] (code_module, code_presentation, id_student, date_registration, date_unregistration) VALUES (?, ?, ?, ?, ?), (?, ?, ?, ?, ?), (?, ?, ?, ?, ?), (?, ?, ?, ?, ?), (?, ?, ?, ?, ?), (?, ?, ?, ?, ?), (?, ?, ?, ?, ?), (?, ? ... 6897 characters truncated ... (?, ?, ?, ?, ?), (?, ?, ?, ?, ?), (?, ?, ?, ?, ?), (?, ?, ?, ?, ?), (?, ?, ?, ?, ?), (?, ?, ?, ?, ?)]
[parameters: ('AAA', '2013J', 11391, 0.33333333333333337, 0.48454882571075397, 'AAA', '2013J', 28400, 0.5501022494887526, 0.48454882571075397, 'AAA', '2013J', 30268, 0.47034764826175873, 0.4660074165636588, 'AAA', '2013J', 31604, 0.5521472392638037, 0.48454882571075397, 'AAA', '2013J', 32885, 0.29856850715746425, 0.48454882571075397, 'AAA', '2013J', 38053, 0.4335378323108385, 0.48454882571075397, 'AAA', '2013J', 45462, 0.5214723926380369, 0.48454882571075397, 'AAA', '2013J', 45642, 0.5991820040899796, 0.48454882571075397, 'AAA', '2013J', 52130, 0.591002044989775, 0.48454882571075397, 'AAA', '2013J', 53025, 0.29243353783231085, 0.48454882571075397 ... 1995 parameters truncated ... 'AAA', '2014J', 111512, 0.6257668711656442, 0.48454882571075397, 'AAA', '2014J', 117818, 0.47034764826175873, 0.48454882571075397, 'AAA', '2014J', 119902, 0.5950920245398773, 0.7070457354758961, 'AAA', '2014J', 121349, 0.6012269938650308, 0.48454882571075397, 'AAA', '2014J', 124064, 0.5685071574642128, 0.48454882571075397, 'AAA', '2014J', 125018, 0.5848670756646217, 0.48454882571075397, 'AAA', '2014J', 129955, 0.36605316973415136, 0.6279357231149567, 'AAA', '2014J', 130034, 0.49079754601227, 0.48454882571075397, 'AAA', '2014J', 130547, 0.6073619631901841, 0.48454882571075397, 'AAA', '2014J', 130636, 0.5194274028629857, 0.48454882571075397)]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-06-10 21:37:17,817 - WARNING - generar_reporte_final -    - studentVle: (pyodbc.IntegrityError) ('23000', '[23000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]The INSERT statement conflicted with the FOREIGN KEY constraint "FK__studentVl__id_st__4AB81AF0". The conflict occurred in database "oulad_db", table "dbo.studentInfo", column \'id_student\'. (547) (SQLExecDirectW); [23000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]The statement has been terminated. (3621)')
[SQL: INSERT INTO [studentVle] (code_module, code_presentation, id_student, id_site, date, sum_click) VALUES (?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?), (?, ?,  ... 6731 characters truncated ... , (?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?)]
[parameters: ('AAA', '2013J', 28400, 546652, -10, 0.00043004587155963305, 'AAA', '2013J', 28400, 546614, -10, 0.0014334862385321102, 'AAA', '2013J', 28400, 546714, -10, 0.0, 'AAA', '2013J', 28400, 546876, -10, 0.00014334862385321102, 'AAA', '2013J', 28400, 546688, -10, 0.0020068807339449542, 'AAA', '2013J', 28400, 546662, -10, 0.0022935779816513763, 'AAA', '2013J', 28400, 546890, -10, 0.0, 'AAA', '2013J', 28400, 547011, -10, 0.0, 'AAA', '2013J' ... 1994 parameters truncated ... -10, 0.0, 'AAA', '2013J', 145130, 546672, -10, 0.0, 'AAA', '2013J', 145130, 546681, -10, 0.0, 'AAA', '2013J', 145130, 546719, -10, 0.00014334862385321102, 'AAA', '2013J', 145130, 546879, -10, 0.0005733944954128441, 'AAA', '2013J', 146188, 546614, -10, 0.0005733944954128441, 'AAA', '2013J', 146188, 546669, -10, 0.0005733944954128441, 'AAA', '2013J', 145130, 546668, -10, 0.0, 'AAA', '2013J', 145130, 546614, -10, 0.0)]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-06-10 21:37:17,817 - WARNING - generar_reporte_final -    - studentAssessment: (pyodbc.IntegrityError) ('23000', '[23000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]The INSERT statement conflicted with the FOREIGN KEY constraint "FK__studentAs__id_st__46E78A0C". The conflict occurred in database "oulad_db", table "dbo.studentInfo", column \'id_student\'. (547) (SQLExecDirectW); [23000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]The statement has been terminated. (3621)')
[SQL: INSERT INTO [studentAssessment] (id_assessment, id_student, date_submitted, is_banked, score) VALUES (?, ?, ?, ?, ?), (?, ?, ?, ?, ?), (?, ?, ?, ?, ?), (?, ?, ?, ?, ?), (?, ?, ?, ?, ?), (?, ?, ?, ?, ?), (?, ?, ?, ?, ?), (?, ?, ?, ?, ?), (?, ?, ?, ?,  ... 6872 characters truncated ... (?, ?, ?, ?, ?), (?, ?, ?, ?, ?), (?, ?, ?, ?, ?), (?, ?, ?, ?, ?), (?, ?, ?, ?, ?), (?, ?, ?, ?, ?)]
[parameters: (1752, 11391, 0.04684975767366721, 0.0, 0.78, 1752, 28400, 0.053311793214862686, 0.0, 0.7000000000000001, 1752, 31604, 0.04523424878836834, 0.0, 0.72, 1752, 32885, 0.05977382875605816, 0.0, 0.6900000000000001, 1752, 38053, 0.048465266558966075, 0.0, 0.79, 1752, 45462, 0.050080775444264945, 0.0, 0.7000000000000001, 1752, 45642, 0.04684975767366721, 0.0, 0.72, 1752, 52130, 0.048465266558966075, 0.0, 0.72, 1752, 53025, 0.03231017770597738, 0.0, 0.71, 1752, 57506, 0.04684975767366721, 0.0, 0.68 ... 1995 parameters truncated ... 1753, 2139353, 0.11308562197092084, 0.0, 0.62, 1753, 2143752, 0.10339256865912763, 0.0, 0.56, 1753, 2146792, 0.10500807754442651, 0.0, 0.6, 1753, 2153153, 0.10339256865912763, 0.0, 0.67, 1753, 2155014, 0.11793214862681745, 0.0, 0.64, 1753, 2171627, 0.09854604200323103, 0.0, 0.67, 1753, 2182846, 0.1001615508885299, 0.0, 0.63, 1753, 2194100, 0.10177705977382875, 0.0, 0.61, 1753, 2197016, 0.1001615508885299, 0.0, 0.75, 1753, 2208424, 0.10339256865912763, 0.0, 0.5700000000000001)]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-06-10 21:37:17,818 - INFO - ejecutar_etl_completo - 🎉 Proceso ETL completado!
2025-06-10 21:37:17,818 - INFO - ejecutar_etl_completo - 📁 Revisa las carpetas generadas para resultados detallados:
2025-06-10 21:37:17,818 - INFO - ejecutar_etl_completo -    - logs/ : Archivos de log del proceso
2025-06-10 21:37:17,818 - INFO - ejecutar_etl_completo -    - metadata/ : Documentación de esquemas
2025-06-10 21:37:17,818 - INFO - ejecutar_etl_completo -    - mappings/ : Mapeos categóricos
2025-06-10 21:37:17,818 - INFO - ejecutar_etl_completo -    - reports/ : Reportes estadísticos
2025-06-10 21:37:17,819 - INFO - ejecutar_etl_completo - 🔌 Conexión BD cerrada
