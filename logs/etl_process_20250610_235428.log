2025-06-10 23:54:28,125 - INFO - configurar_logging - ============================================================
2025-06-10 23:54:28,125 - INFO - configurar_logging - 🚀 INICIANDO PROCESO ETL
2025-06-10 23:54:28,125 - INFO - configurar_logging - ============================================================
2025-06-10 23:54:28,776 - INFO - _conectar_bd - ✅ Conexión exitosa a BD: oulad_db
2025-06-10 23:54:28,776 - INFO - ejecutar_etl_completo - 🚀 Iniciando proceso ETL completo...
2025-06-10 23:54:28,776 - INFO - limpiar_tablas_bd - 🧹 Iniciando limpieza de tablas...
2025-06-10 23:54:28,777 - INFO - limpiar_tablas_bd - 🗑️ Limpiando tabla studentAssessment...
2025-06-10 23:54:28,811 - INFO - limpiar_tablas_bd - ✅ 0 registros eliminados de studentAssessment
2025-06-10 23:54:28,811 - INFO - limpiar_tablas_bd - 🗑️ Limpiando tabla studentVle...
2025-06-10 23:54:28,813 - INFO - limpiar_tablas_bd - ✅ 0 registros eliminados de studentVle
2025-06-10 23:54:28,813 - INFO - limpiar_tablas_bd - 🗑️ Limpiando tabla studentRegistration...
2025-06-10 23:54:28,888 - INFO - limpiar_tablas_bd - ✅ 32593 registros eliminados de studentRegistration
2025-06-10 23:54:28,921 - INFO - limpiar_tablas_bd - 🗑️ Limpiando tabla studentInfo...
2025-06-10 23:54:29,121 - INFO - limpiar_tablas_bd - ✅ 28785 registros eliminados de studentInfo
2025-06-10 23:54:29,121 - INFO - limpiar_tablas_bd - 🗑️ Limpiando tabla assessments...
2025-06-10 23:54:29,200 - INFO - limpiar_tablas_bd - ✅ 0 registros eliminados de assessments
2025-06-10 23:54:29,201 - INFO - limpiar_tablas_bd - 🗑️ Limpiando tabla vle...
2025-06-10 23:54:29,359 - INFO - limpiar_tablas_bd - ✅ 0 registros eliminados de vle
2025-06-10 23:54:29,359 - INFO - limpiar_tablas_bd - 🗑️ Limpiando tabla courses...
2025-06-10 23:54:29,387 - INFO - limpiar_tablas_bd - ✅ 22 registros eliminados de courses
2025-06-10 23:54:29,388 - INFO - procesar_tabla - 📤 Procesando courses desde data/raw/courses.csv...
2025-06-10 23:54:29,392 - INFO - procesar_tabla - 📊 Cargados 22 registros
2025-06-10 23:54:29,393 - INFO - limpiar_valores_nulos - 🧹 Limpiando 0 valores NaN...
2025-06-10 23:54:29,397 - INFO - limpiar_valores_nulos - ✅ Limpieza completa: 0 → 0 valores NaN
2025-06-10 23:54:29,398 - INFO - normalizar_columnas_numericas - 📊 Normalizando 1 columnas numéricas (excluyendo claves primarias)...
2025-06-10 23:54:29,403 - INFO - normalizar_columnas_numericas - ✅ Normalización completada
2025-06-10 23:54:29,404 - INFO - convertir_categoricas_a_ordinales - 🔄 Convirtiendo 2 columnas categóricas a ordinales...
2025-06-10 23:54:29,467 - INFO - obtener_columnas_validas - 📋 Tabla courses: 3 columnas válidas
2025-06-10 23:54:29,467 - WARNING - procesar_tabla - ⚠️ Columnas omitidas: ['code_module_ord', 'code_presentation_ord']
2025-06-10 23:54:29,468 - INFO - validar_datos_pre_insercion - 🔍 Validando datos para tabla courses...
2025-06-10 23:54:29,470 - INFO - validar_datos_pre_insercion - ✅ Validación pre-inserción exitosa
2025-06-10 23:54:29,478 - INFO - generar_full_domain - 📚 Metadatos guardados: metadata/full_domains\courses_domain.json y metadata/full_domains\courses_domain.csv
2025-06-10 23:54:29,478 - INFO - procesar_tabla - 💾 Insertando 22 registros en courses...
2025-06-10 23:54:29,524 - INFO - guardar_mapeos - 🗂️ Mapeos guardados: mappings/courses_mappings.json
2025-06-10 23:54:29,524 - INFO - procesar_tabla - ✅ Tabla courses procesada exitosamente
2025-06-10 23:54:29,525 - INFO - procesar_tabla - 📤 Procesando vle desde data/raw/vle.csv...
2025-06-10 23:54:29,531 - INFO - procesar_tabla - 📊 Cargados 6364 registros
2025-06-10 23:54:29,532 - INFO - limpiar_valores_nulos - 🧹 Limpiando 10486 valores NaN...
2025-06-10 23:54:29,536 - INFO - limpiar_valores_nulos - ✅ Limpieza completa: 10486 → 0 valores NaN
2025-06-10 23:54:29,536 - INFO - normalizar_columnas_numericas - 📊 Normalizando 2 columnas numéricas (excluyendo claves primarias)...
2025-06-10 23:54:29,539 - INFO - normalizar_columnas_numericas - ✅ Normalización completada
2025-06-10 23:54:29,539 - INFO - procesar_tabla - 🚀 Aplicando FullDomain a vle...
2025-06-10 23:54:29,539 - INFO - crear_fulldomain_vle - 🔧 Creando FullDomain para VLE...
2025-06-10 23:54:29,544 - INFO - crear_fulldomain_vle - ✅ FullDomain creado. Ejemplo: resource_Puntual_Sin_Datos
2025-06-10 23:54:29,589 - WARNING - validar_fulldomain_vle - ⚠️ 293 registros con activity_type NO esperado.
2025-06-10 23:54:29,593 - INFO - guardar_reporte_fulldomain - 📊 Reporte FullDomain: reports/vle_fulldomain_report.json
2025-06-10 23:54:29,594 - INFO - convertir_categoricas_a_ordinales - 🔄 Convirtiendo 6 columnas categóricas a ordinales...
2025-06-10 23:54:29,622 - INFO - obtener_columnas_validas - 📋 Tabla vle: 6 columnas válidas
2025-06-10 23:54:29,623 - WARNING - procesar_tabla - ⚠️ Columnas omitidas: ['week_span', 'week_span_category', 'click_category', 'FullDomain', 'code_module_ord', 'code_presentation_ord', 'activity_type_ord', 'week_span_category_ord', 'click_category_ord', 'FullDomain_ord']
2025-06-10 23:54:29,624 - INFO - validar_datos_pre_insercion - 🔍 Validando datos para tabla vle...
2025-06-10 23:54:29,631 - INFO - validar_datos_pre_insercion - ✅ Validación pre-inserción exitosa
2025-06-10 23:54:29,639 - INFO - generar_full_domain - 📚 Metadatos guardados: metadata/full_domains\vle_domain.json y metadata/full_domains\vle_domain.csv
2025-06-10 23:54:29,640 - INFO - procesar_tabla - 💾 Insertando 6364 registros en vle...
2025-06-10 23:54:29,908 - INFO - guardar_mapeos - 🗂️ Mapeos guardados: mappings/vle_mappings.json
2025-06-10 23:54:29,909 - INFO - procesar_tabla - ✅ Tabla vle procesada exitosamente
2025-06-10 23:54:29,909 - INFO - procesar_tabla - 📤 Procesando assessments desde data/raw/assessments.csv...
2025-06-10 23:54:29,910 - INFO - procesar_tabla - 📊 Cargados 206 registros
2025-06-10 23:54:29,911 - INFO - limpiar_valores_nulos - 🧹 Limpiando 11 valores NaN...
2025-06-10 23:54:29,913 - INFO - limpiar_valores_nulos - ✅ Limpieza completa: 11 → 0 valores NaN
2025-06-10 23:54:29,913 - INFO - normalizar_columnas_numericas - 📊 Normalizando 2 columnas numéricas (excluyendo claves primarias)...
2025-06-10 23:54:29,916 - INFO - normalizar_columnas_numericas - ✅ Normalización completada
2025-06-10 23:54:29,916 - INFO - procesar_tabla - 🚀 Aplicando FullDomain a assessments...
2025-06-10 23:54:29,916 - INFO - crear_fulldomain_assessments - 🔧 Creando FullDomain para assessments...
2025-06-10 23:54:29,918 - INFO - crear_fulldomain_assessments - ✅ FullDomain creado. Ejemplo: TMA_Bajo_Temprano
2025-06-10 23:54:29,919 - WARNING - validar_fulldomain_assessments - ⚠️ La columna 'score' no está presente en assessments.
2025-06-10 23:54:29,919 - INFO - convertir_categoricas_a_ordinales - 🔄 Convirtiendo 6 columnas categóricas a ordinales...
2025-06-10 23:54:29,946 - INFO - obtener_columnas_validas - 📋 Tabla assessments: 6 columnas válidas
2025-06-10 23:54:29,946 - WARNING - procesar_tabla - ⚠️ Columnas omitidas: ['weight_category', 'date_category', 'FullDomain', 'code_module_ord', 'code_presentation_ord', 'assessment_type_ord', 'weight_category_ord', 'date_category_ord', 'FullDomain_ord']
2025-06-10 23:54:29,948 - INFO - validar_datos_pre_insercion - 🔍 Validando datos para tabla assessments...
2025-06-10 23:54:29,950 - INFO - validar_datos_pre_insercion - ✅ Validación pre-inserción exitosa
2025-06-10 23:54:29,955 - INFO - generar_full_domain - 📚 Metadatos guardados: metadata/full_domains\assessments_domain.json y metadata/full_domains\assessments_domain.csv
2025-06-10 23:54:29,955 - INFO - procesar_tabla - 💾 Insertando 206 registros en assessments...
2025-06-10 23:54:30,006 - INFO - guardar_mapeos - 🗂️ Mapeos guardados: mappings/assessments_mappings.json
2025-06-10 23:54:30,006 - INFO - procesar_tabla - ✅ Tabla assessments procesada exitosamente
2025-06-10 23:54:30,006 - INFO - procesar_tabla - 📤 Procesando studentInfo desde data/raw/studentInfo.csv...
2025-06-10 23:54:30,049 - INFO - procesar_tabla - 📊 Cargados 32593 registros
2025-06-10 23:54:30,059 - INFO - limpiar_valores_nulos - 🧹 Limpiando 1111 valores NaN...
2025-06-10 23:54:30,086 - INFO - limpiar_valores_nulos - ✅ Limpieza completa: 1111 → 0 valores NaN
2025-06-10 23:54:30,087 - INFO - normalizar_columnas_numericas - 📊 Normalizando 2 columnas numéricas (excluyendo claves primarias)...
2025-06-10 23:54:30,090 - INFO - normalizar_columnas_numericas - ✅ Normalización completada
2025-06-10 23:54:30,094 - INFO - convertir_categoricas_a_ordinales - 🔄 Convirtiendo 9 columnas categóricas a ordinales...
2025-06-10 23:54:30,128 - INFO - procesar_tabla - 🔄 Eliminados 3808 duplicados
2025-06-10 23:54:30,129 - INFO - obtener_columnas_validas - 📋 Tabla studentInfo: 12 columnas válidas
2025-06-10 23:54:30,129 - WARNING - procesar_tabla - ⚠️ Columnas omitidas: ['code_module_ord', 'code_presentation_ord', 'gender_ord', 'region_ord', 'highest_education_ord', 'imd_band_ord', 'age_band_ord', 'disability_ord', 'final_result_ord']
2025-06-10 23:54:30,133 - INFO - validar_datos_pre_insercion - 🔍 Validando datos para tabla studentInfo...
2025-06-10 23:54:30,210 - INFO - validar_datos_pre_insercion - ✅ Validación pre-inserción exitosa
2025-06-10 23:54:30,263 - INFO - generar_full_domain - 📚 Metadatos guardados: metadata/full_domains\studentInfo_domain.json y metadata/full_domains\studentInfo_domain.csv
2025-06-10 23:54:30,264 - INFO - procesar_tabla - 💾 Insertando 28785 registros en studentInfo...
2025-06-10 23:54:31,839 - INFO - guardar_mapeos - 🗂️ Mapeos guardados: mappings/studentInfo_mappings.json
2025-06-10 23:54:31,840 - INFO - procesar_tabla - ✅ Tabla studentInfo procesada exitosamente
2025-06-10 23:54:31,840 - INFO - procesar_tabla - 📤 Procesando studentRegistration desde data/raw/studentRegistration.csv...
2025-06-10 23:54:31,870 - INFO - procesar_tabla - 📊 Cargados 32593 registros
2025-06-10 23:54:31,874 - INFO - limpiar_valores_nulos - 🧹 Limpiando 22566 valores NaN...
2025-06-10 23:54:31,883 - INFO - limpiar_valores_nulos - ✅ Limpieza completa: 22566 → 0 valores NaN
2025-06-10 23:54:31,884 - INFO - normalizar_columnas_numericas - 📊 Normalizando 2 columnas numéricas (excluyendo claves primarias)...
2025-06-10 23:54:31,887 - INFO - normalizar_columnas_numericas - ✅ Normalización completada
2025-06-10 23:54:31,889 - INFO - convertir_categoricas_a_ordinales - 🔄 Convirtiendo 2 columnas categóricas a ordinales...
2025-06-10 23:54:31,919 - INFO - obtener_columnas_validas - 📋 Tabla studentRegistration: 5 columnas válidas
2025-06-10 23:54:31,919 - WARNING - procesar_tabla - ⚠️ Columnas omitidas: ['code_module_ord', 'code_presentation_ord']
2025-06-10 23:54:31,921 - INFO - validar_datos_pre_insercion - 🔍 Validando datos para tabla studentRegistration...
2025-06-10 23:54:31,946 - INFO - validar_datos_pre_insercion - ✅ Validación pre-inserción exitosa
2025-06-10 23:54:31,964 - INFO - generar_full_domain - 📚 Metadatos guardados: metadata/full_domains\studentRegistration_domain.json y metadata/full_domains\studentRegistration_domain.csv
2025-06-10 23:54:31,965 - INFO - procesar_tabla - 💾 Insertando 32593 registros en studentRegistration...
2025-06-10 23:54:33,074 - INFO - guardar_mapeos - 🗂️ Mapeos guardados: mappings/studentRegistration_mappings.json
2025-06-10 23:54:33,074 - INFO - procesar_tabla - ✅ Tabla studentRegistration procesada exitosamente
2025-06-10 23:54:33,075 - INFO - procesar_tabla - 📤 Procesando studentVle desde data/raw/studentVle.csv...
2025-06-10 23:54:36,902 - INFO - procesar_tabla - 📊 Cargados 10655280 registros
2025-06-10 23:54:37,508 - INFO - limpiar_valores_nulos - 🧹 Limpiando 0 valores NaN...
2025-06-10 23:54:39,739 - INFO - limpiar_valores_nulos - ✅ Limpieza completa: 0 → 0 valores NaN
2025-06-10 23:54:39,957 - INFO - normalizar_columnas_numericas - 📊 Normalizando 1 columnas numéricas (excluyendo claves primarias)...
2025-06-10 23:54:40,118 - INFO - normalizar_columnas_numericas - ✅ Normalización completada
2025-06-10 23:54:40,463 - INFO - convertir_categoricas_a_ordinales - 🔄 Convirtiendo 2 columnas categóricas a ordinales...
2025-06-10 23:54:44,821 - INFO - procesar_tabla - 🔄 Eliminados 2195960 duplicados
2025-06-10 23:54:44,838 - INFO - obtener_columnas_validas - 📋 Tabla studentVle: 6 columnas válidas
2025-06-10 23:54:44,839 - WARNING - procesar_tabla - ⚠️ Columnas omitidas: ['code_module_ord', 'code_presentation_ord']
2025-06-10 23:54:45,179 - INFO - validar_datos_pre_insercion - 🔍 Validando datos para tabla studentVle...
2025-06-10 23:54:51,982 - INFO - validar_datos_pre_insercion - ✅ Validación pre-inserción exitosa
2025-06-10 23:54:55,317 - INFO - generar_full_domain - 📚 Metadatos guardados: metadata/full_domains\studentVle_domain.json y metadata/full_domains\studentVle_domain.csv
2025-06-10 23:54:55,317 - INFO - procesar_tabla - 💾 Insertando 8459320 registros en studentVle...
2025-06-11 00:17:47,981 - INFO - guardar_mapeos - 🗂️ Mapeos guardados: mappings/studentVle_mappings.json
2025-06-11 00:17:47,981 - INFO - procesar_tabla - ✅ Tabla studentVle procesada exitosamente
2025-06-11 00:17:48,119 - INFO - procesar_tabla - 📤 Procesando studentAssessment desde data/raw/studentAssessment.csv...
2025-06-11 00:17:48,204 - INFO - procesar_tabla - 📊 Cargados 173912 registros
2025-06-11 00:17:48,205 - INFO - limpiar_valores_nulos - 🧹 Limpiando 173 valores NaN...
2025-06-11 00:17:48,222 - INFO - limpiar_valores_nulos - ✅ Limpieza completa: 173 → 0 valores NaN
2025-06-11 00:17:48,228 - INFO - normalizar_columnas_numericas - 📊 Normalizando 3 columnas numéricas (excluyendo claves primarias)...
2025-06-11 00:17:48,245 - INFO - normalizar_columnas_numericas - ✅ Normalización completada
2025-06-11 00:17:48,330 - INFO - obtener_columnas_validas - 📋 Tabla studentAssessment: 5 columnas válidas
2025-06-11 00:17:48,334 - INFO - validar_datos_pre_insercion - 🔍 Validando datos para tabla studentAssessment...
2025-06-11 00:17:48,353 - INFO - validar_datos_pre_insercion - ✅ Validación pre-inserción exitosa
2025-06-11 00:17:48,392 - INFO - generar_full_domain - 📚 Metadatos guardados: metadata/full_domains\studentAssessment_domain.json y metadata/full_domains\studentAssessment_domain.csv
2025-06-11 00:17:48,393 - INFO - procesar_tabla - 💾 Insertando 173912 registros en studentAssessment...
2025-06-11 00:17:52,366 - INFO - procesar_tabla - ✅ Tabla studentAssessment procesada exitosamente
2025-06-11 00:17:52,367 - INFO - generar_reporte_final - 📋 Generando reporte final...
2025-06-11 00:17:52,368 - INFO - generar_reporte_final - ✅ Reporte final: reports/etl_final_report_20250611_001752.json
2025-06-11 00:17:52,368 - INFO - generar_reporte_final - ============================================================
2025-06-11 00:17:52,368 - INFO - generar_reporte_final - 📊 RESUMEN FINAL DEL PROCESO ETL
2025-06-11 00:17:52,369 - INFO - generar_reporte_final - ============================================================
2025-06-11 00:17:52,369 - INFO - generar_reporte_final - ✅ Tablas procesadas: 7
2025-06-11 00:17:52,369 - INFO - generar_reporte_final - 📝 Registros insertados: 8701202
2025-06-11 00:17:52,369 - INFO - generar_reporte_final - ⏱️ Duración total: 0:23:24.241254
2025-06-11 00:17:52,369 - INFO - generar_reporte_final - ❌ Errores: 0
2025-06-11 00:17:52,369 - INFO - ejecutar_etl_completo - 🎉 Proceso ETL completado!
2025-06-11 00:17:52,369 - INFO - ejecutar_etl_completo - 📁 Revisa las carpetas generadas para resultados detallados:
2025-06-11 00:17:52,369 - INFO - ejecutar_etl_completo -    - logs/ : Archivos de log del proceso
2025-06-11 00:17:52,369 - INFO - ejecutar_etl_completo -    - metadata/ : Documentación de esquemas
2025-06-11 00:17:52,369 - INFO - ejecutar_etl_completo -    - mappings/ : Mapeos categóricos
2025-06-11 00:17:52,369 - INFO - ejecutar_etl_completo -    - reports/ : Reportes estadísticos
2025-06-11 00:17:52,370 - INFO - ejecutar_etl_completo - 🔌 Conexión BD cerrada
